<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Producto | Maya Kab</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet" />
  <link rel="stylesheet" href="../css/estilos.css">
  <style>
    :root {
      --color-principal: #632D41;
      --color-acento: #cc722e91;
      --color-texto: wheat;
    }
bg-light{
    background-color: #146c43;
}
    .toast-container {
      position: fixed;
      top: 80px;
      right: 20px;
      z-index: 9999;
    }

    .thumbnail {
      cursor: pointer;
      max-height: 70px;
      object-fit: cover;
      border: 2px solid transparent;
      border-radius: 5px;
      transition: transform 0.3s ease, border-color 0.3s ease;
    }

    .thumbnail:hover {
      transform: scale(1.05);
      border-color: var(--color-principal);
    }

    .main-img {
      width: 100%;
      max-height: 500px;
      object-fit: cover;
      border-radius: 10px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
    }

    .btn-primary {
      background-color: var(--color-principal);
      border-color: var(--color-principal);
    }

    .btn-primary:hover {
      background-color: #4e2032;
      border-color: #4e2032;
    }

    .fondo-producto {
      background-color: #FFF0E8;
      padding: 2rem;
      border-radius: 10px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
    }

    .bg-navbar {
      background-color: var(--color-acento);
    }

    .badge.bg-danger {
      background-color: #b80000;
    }
    .btn-volver {
  background-color: #198754;
  color: white;
  border: none;
  transition: background-color 0.3s ease;
}

.btn-volver:hover {
  background-color: #146c43;
}
.creador-info {
  text-align: center;
}
.creador-info img {
  width: 120px;
  height: 120px;
  object-fit: cover;
  border-radius: 50%;
  border: 3px solid var(--color-principal);
  margin-bottom: 1rem;
}
  </style>
</head>
<body class="bg-light">

<!-- Navbar -->
<nav class="navbar navbar-expand-lg shadow-sm fixed-top bg-white">
  <div class="container">
    <a class="navbar-brand fw-bold text-uppercase" href="#">
      <img src="../img/logo.png" alt="Maya Kab" width="50"> Maya Kab
    </a>

    <!-- Botón hamburguesa -->
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#menuNav"
      aria-controls="menuNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <!-- Menú colapsable -->
    <div class="collapse navbar-collapse" id="menuNav">
      <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
        <li class="nav-item"><a class="nav-link " href="home.html">Inicio</a></li>
        <li class="nav-item"><a class="nav-link active" href="tienda.html">Tienda</a></li>
        <li class="nav-item"><a class="nav-link" href="servicios.html">Servicios</a></li>
        <li class="nav-item"><a class="nav-link" href="sobre_nosotros.html">Sobre nosotros</a></li>
        <li class="nav-item"><a class="nav-link" href="contactenos.html">Contactenos</a></li>
        <li class="nav-item">
          <a class="nav-link position-relative" href="carrito.html">
            <img src="../img/carrito.svg" alt="Carrito" width="20" class="me-1" />
            <span id="cart-count" class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">0</span>
          </a>
        </li>
      </ul>
    </div>
  </div>
</nav>

<!-- Contenido -->
<!-- Dentro del contenedor -->
<div class="container mt-3 pt-3">

<!-- Ajuste de margen inferior al botón -->
<a href="tienda.html" class="btn btn-volver mb-4">← Volver a tienda</a>

<div class="row g-4 fondo-producto">
  <!-- Info del creador -->
  <div class="col-md-3">
    <div class="creador-info">
      <img src="../img/p1.jpg" alt="Creador">
      <h5 class="mt-2">Juana López</h5>
      <p class="text-muted mb-1">Mérida, Yucatán</p>
      <p class="small">Juana es una artesana con más de 15 años de experiencia, especializada en productos de palma tejida y bordado tradicional. Cada pieza es elaborada con amor y técnicas ancestrales.</p>
    </div>
  </div>

  <!-- Imágenes del producto -->
  <div class="col-md-5">
    <img id="producto-img" class="main-img" alt="">
    <div class="d-flex gap-2 mt-3" id="miniaturas"></div>
  </div>

  <!-- Detalles del producto -->
  <div class="col-md-4">
    <h2 id="producto-nombre" class="fw-bold"></h2>
    <p class="text-muted">Creado por: <span id="producto-creador"></span></p>
    <p class="fs-5">Precio: $<span id="producto-precio"></span></p>
    <p>Disponibles: <span id="producto-cantidad"></span></p>

    <!-- NUEVO INPUT PARA CANTIDAD -->
    <div class="mt-3">
      <label for="inputCantidad" class="form-label">Cantidad:</label>
      <input type="number" id="inputCantidad" class="form-control" value="1" min="1" />
    </div>

    <!-- BOTÓN ACTUALIZADO -->
    <button class="btn btn-primary mt-3 w-100 d-flex align-items-center justify-content-center" onclick="agregarAlCarrito()">
      <img src="../img/carrito.svg" alt="Agregar" width="20" class="me-2" style="filter: brightness(0) invert(1);"> Agregar al carrito
    </button>
  </div>
</div>
  <!-- Video del producto -->
  <hr class="my-5">
  <h4 class="mb-3">Video del producto</h4>
  <div class="ratio ratio-16x9">
    <iframe src="https://youtu.be/zjvACmNoIyc" title="Video del producto" allowfullscreen></iframe>
  </div>
</div>

<!-- Toasts -->
<div class="toast-container"></div>

<!-- Scripts -->
<script>
  const params = new URLSearchParams(window.location.search);
  const imagenPrincipal = document.getElementById('producto-img');
  const miniaturas = document.getElementById('miniaturas');

  const imagenes = [
    params.get('imagen'),
    params.get('img2'),
    params.get('img3'),
    params.get('img4'),
  ].filter(Boolean);

  imagenPrincipal.src = imagenes[0];

  imagenes.forEach(src => {
    const img = document.createElement('img');
    img.src = src;
    img.className = 'thumbnail';
    img.onclick = () => imagenPrincipal.src = src;
    miniaturas.appendChild(img);
  });

  document.getElementById('producto-nombre').textContent = params.get('nombre');
  document.getElementById('producto-creador').textContent = params.get('creador');
  document.getElementById('producto-precio').textContent = params.get('precio');
  document.getElementById('producto-cantidad').textContent = params.get('cantidad');

  // Asignar max al input de cantidad
  const cantidadDisponible = parseInt(params.get('cantidad'));
  document.getElementById('inputCantidad').max = cantidadDisponible;

  function agregarAlCarrito() {
    const cantidad = parseInt(document.getElementById('inputCantidad').value);
    const disponibles = cantidadDisponible;

    if (isNaN(cantidad) || cantidad <= 0) {
      mostrarToast("Ingresa una cantidad válida.");
      return;
    }

    if (cantidad > disponibles) {
      mostrarToast("Cantidad solicitada supera el stock disponible.");
      return;
    }

    let carrito = JSON.parse(localStorage.getItem('carrito')) || [];

    for (let i = 0; i < cantidad; i++) {
      carrito.push({
        nombre: params.get('nombre'),
        precio: params.get('precio'),
        imagen: params.get('imagen')
      });
    }

    localStorage.setItem('carrito', JSON.stringify(carrito));
    actualizarContador();
    mostrarToast(`Se agregaron ${cantidad} producto(s) al carrito`);
  }

  function actualizarContador() {
    const carrito = JSON.parse(localStorage.getItem('carrito')) || [];
    document.getElementById('cart-count').textContent = carrito.length;
  }

  function mostrarToast(mensaje) {
    const toastHTML = `
      <div class="toast align-items-center text-bg-success border-0 mb-2 show" role="alert">
        <div class="d-flex">
          <div class="toast-body">${mensaje}</div>
          <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button>
        </div>
      </div>`;
    document.querySelector('.toast-container').insertAdjacentHTML('beforeend', toastHTML);
    setTimeout(() => document.querySelector('.toast-container').firstChild?.remove(), 3000);
  }

  actualizarContador();
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
